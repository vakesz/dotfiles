##### ── General ─────────────────────────────────────────────────────────────
set -g mouse on
set -g history-limit 50000
set -s escape-time 0
set -g base-index 1
setw -g pane-base-index 1
set -g renumber-windows on
set -g repeat-time 200
set -g set-clipboard on
set -g focus-events on

# Terminal / colors (enables 24-bit truecolor pass-through)
set -g default-terminal "tmux-256color"
set -ga terminal-overrides ",*:RGB"

##### ── Prefix & core bindings ─────────────────────────────────────────────
unbind C-b
set -g prefix C-a
bind C-a send-prefix
bind r source-file "$XDG_CONFIG_HOME/tmux/tmux.conf" \; display "tmux.conf reloaded ✔"

# Splits like Vim
unbind '"'
unbind %
bind | split-window -h
bind - split-window -v

# Pane navigation with Ctrl-h/j/k/l
bind -n C-h select-pane -L
bind -n C-j select-pane -D
bind -n C-k select-pane -U
bind -n C-l select-pane -R

# Allow clearing screen with prefix + C-l (since C-l is used for pane nav)
bind C-l send-keys 'C-l'

# Resize panes quickly
bind -r C-Left  resize-pane -L 5
bind -r C-Right resize-pane -R 5
bind -r C-Up    resize-pane -U 5
bind -r C-Down  resize-pane -D 5

# Quick window cycling
bind -n M-Left  previous-window
bind -n M-Right next-window

##### ── Copy mode & clipboard (vi keys, cross-platform) ────────────────────
setw -g mode-keys vi

# y / Enter copy selection to system clipboard (platform-aware)
if-shell "command -v pbcopy >/dev/null" {
    bind -T copy-mode-vi y     send -X copy-pipe-and-cancel "pbcopy"
    bind -T copy-mode-vi Enter send -X copy-pipe-and-cancel "pbcopy"
    bind -T copy-mode-vi MouseDragEnd1Pane send -X copy-pipe-and-cancel "pbcopy"
} {
    bind -T copy-mode-vi y     send -X copy-pipe-and-cancel "xclip -selection clipboard"
    bind -T copy-mode-vi Enter send -X copy-pipe-and-cancel "xclip -selection clipboard"
    bind -T copy-mode-vi MouseDragEnd1Pane send -X copy-pipe-and-cancel "xclip -selection clipboard"
}

##### ── Theme: Tokyo Night (truecolor hex, no variables in color fields) ──────
# Palette (hex used directly in style fields)
# bg=#1a1b26 subtle=#737aa2 comment=#565f89 fg=#c0caf5
# red=#f7768e yellow=#e0af68 cyan=#7dcfff purple=#bb9af7

# Statusline
set -g status on
set -g status-interval 5
set -g status-justify centre
set -g status-bg "#1a1b26"
set -g status-fg "#737aa2"

set -g status-left-length 40
set -g status-right-length 80
set -g status-left  "#[fg=#7dcfff,bold] #S #[fg=#737aa2]"
set -g status-right "#[fg=#737aa2] #[fg=#bb9af7]%Y-%m-%d %H:%M #[fg=#e0af68] #[fg=#f7768e]#(whoami)"

# Window titles
setw -g window-status-separator ""
setw -g window-status-format         " #[fg=#565f89]#I:#W "
setw -g window-status-current-format "#[fg=#1a1b26,bg=#7dcfff,bold] #I:#W #[default]"

# Pane borders
set -g pane-border-style        "fg=#565f89"
set -g pane-active-border-style "fg=#7dcfff"

# Message / prompt styling
set -g message-style "bg=#1a1b26,fg=#c0caf5"
set -g message-command-style "bg=#1a1b26,fg=#c0caf5"
set -g mode-style "bg=#565f89,fg=#1a1b26"

##### ── QoL tweaks ─────────────────────────────────────────────────────────
set -g visual-bell off
setw -g monitor-activity on
set -g activity-action other

set -g set-titles on
set -g set-titles-string "#S: #W — tmux"
